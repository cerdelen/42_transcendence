generator client {
	provider = "prisma-client-js"
	binaryTargets = ["native", "linux-musl-openssl-3.0.x", "linux-musl-arm64-openssl-3.0.x"]
}

datasource backend_database {
	provider	= "postgresql"
	url			= env("DATABASE_URL")
}

// ? means a field is optional

model User {
	// User stuff
	id						Int			@unique
	name					String		@unique
	mail					String
	// chatParticipant	ChatParticipant?	@relation(fields: [chatPtsId], references: [ChatPartId])
	conversation_id_arr		Int[]

	// picture			String?
	// 2_FA_stuff
	two_FA_enabled	Boolean    @default(false)
	two_FA_secret	String?
	friendlist		Int[]
	stats			Stats?
	games			Int[]				// ids of games??
	show_default_image		Boolean		@default(false)
}

model Stats {
	user			User		@relation(fields: [stat_id], references: [id])
	stat_id			Int			@unique 
	wins			Int			@default(0)
	loses			Int			@default(0)
	mmr				Int			@default(1500)
	achievement_0	Boolean		@default(false)										// win 3 games
	achievement_1	Boolean		@default(false)										// reach 1700 mmr
	achievement_2	Boolean		@default(false)										// win to zero
}

model Conversation {
	// User stuff
	conversation_id					Int					@unique  @id @default(autoincrement()) 
	conversation_name				String?		
	conversation_msg_arr			Message[]
	conversation_created_at			DateTime			@default(now())
	// chat_participants	ChatParticipant[]
	conversation					Boolean				@default(true)
	//something to consider later after creating chat
	conversation_is_public			Boolean		@default(true)
	conversation_pass_protected		Boolean		@default(false)
	conversation_password			String?		

	conversation_participant_arr	Int[]
	conversation_owner_arr			Int[]
	conversation_admin_arr			Int[] 
	conversation_black_list_arr		Int[]
	conversation_mute_list_arr		Int[]

	//sorry but i gotta do this
	group_chat						Boolean		@default(false)
}

// model ChatParticipant {

// 	ChatPartId		Int				@unique @id @default(autoincrement())
// 	// chat			Chat			@relation(fields: [ChatPartId], references: [chat_id])
// 	chat			Chat[]
// 	// user			User?			@relation(fields: [userId], references: [id])
// 	userId			User?			

// 	// @@map(name: "chat_role")
// }

model Message {
	// User stuff
	msg_id				Int			@unique  @id @default(autoincrement()) 
	author				Int?		
	// user_name			String		
	text				String
	created_at			DateTime	@default(now())
	//necessary fro array of messages in Chat model
	conversation_id				Int?			
	// usr_id						Int?			
	conversation_relation		Conversation?		@relation(fields: [conversation_id], references: [conversation_id])
	user_relation				User?				@relation(fields: [author], references: [id])		
}

model Game {
	id					Int @unique @id @default(autoincrement())
	player_one			Int
	player_two			Int @default(0)
	winner				Int	@default(0)
	loser				Int @default(0)
	score_one			Int @default(0)
	score_two			Int @default(0)
	finished			Boolean		@default(false)
}